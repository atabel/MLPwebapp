/* Monocle 1.0.0 | http://monocle.tapquo.com | Copyright (C) 2011,2012 Javi Jim√©nez Villar (@soyjavi) */
(function(){var o,m,k,j,g=[].slice,d=[].indexOf||function(c){for(var e=0,b=this.length;e<b;e++)if(e in this&&this[e]===c)return e;return-1},a={}.hasOwnProperty,f=function(c,e){function b(){this.constructor=c}for(var i in e)if(a.call(e,i))c[i]=e[i];b.prototype=e.prototype;c.prototype=new b;c.__super__=e.prototype;return c};o={bind:function(c,e){var b,i,h,l,n;i=c.split(" ");b=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={});l=0;for(n=i.length;l<n;l++){h=i[l];b[h]||(b[h]=[]);
b[h].push(e)}return this},trigger:function(){var c,e,b,i,h;c=1<=arguments.length?g.call(arguments,0):[];b=c.shift();if(b=this.hasOwnProperty("_callbacks")&&((e=this._callbacks)!=null?e[b]:void 0)){i=0;for(h=b.length;i<h;i++){e=b[i];if(e.apply(this,c)===false)break}return true}},unbind:function(c,e){var b,i,h,l,n;if(!c){this._callbacks={};return this}h=(b=this._callbacks)!=null?b[c]:void 0;if(!h)return this;if(!e){delete this._callbacks[c];return this}i=l=0;for(n=h.length;l<n;i=++l){b=h[i];if(b===
e){h=h.slice();h.splice(i,1);this._callbacks[c]=h;break}}return this}};j=["included","extended"];m=function(){function c(){typeof this.init==="function"&&this.init.apply(this,args)}c.include=function(e){var b,i;if(!e)throw Error("include(obj) requires obj");for(b in e){i=e[b];if(d.call(j,b)<0)this.prototype[b]=i}(e=e.included)&&e.apply(this);return this};c.extend=function(e){var b,i;if(!e)throw Error("extend(obj) requires obj");for(b in e){i=e[b];if(d.call(j,b)<0)this[b]=i}if((e=e.extended)!=null)e.apply(this);
return this};c.proxy=function(e){var b=this;return function(){return e.apply(b,arguments)}};c.prototype.proxy=function(e){var b=this;return function(){return e.apply(b,arguments)}};c.prototype.delay=function(e,b){return setTimeout(this.proxy(e),b||0)};return c}();k=this.Monocle={};k.version="0.9.4";k.Events=o;k.Module=m;k.Templates={};k.Dom=function(){var c;c=1<=arguments.length?g.call(arguments,0):[];return typeof $$!=="undefined"&&$$!==null?$$.apply(null,c):$.apply(null,c)};m.extend.call(k,o);m.create=
function(c,e){var b;b=function(i){function h(){return h.__super__.constructor.apply(this,arguments)}f(h,i);return h}(this);c&&b.include(c);e&&b.extend(e);typeof b.unbind==="function"&&b.unbind();return b};this.__=k.App={Model:{},View:{},Controller:{}};this.__Model=k.App.Model;this.__View=k.App.View;this.__Controller=k.App.Controller}).call(this);(function(){var o,m={}.hasOwnProperty,k=function(g,d){function a(){this.constructor=g}for(var f in d)if(m.call(d,f))g[f]=d[f];a.prototype=d.prototype;g.prototype=new a;g.__super__=d.prototype;return g},j=[].slice;Monocle.Model=function(g){function d(a){d.__super__.constructor.apply(this,arguments);this.className=this.constructor.name;a&&this.load(a);this.uid=this.constructor.uid()}k(d,g);d.extend(Monocle.Events);d.records={};d.attributes=[];d.fields=function(){var a;a=1<=arguments.length?j.call(arguments,
0):[];this.records={};if(a.length)this.attributes=a;this.attributes||(this.attributes=[]);this.unbind();return this};d.create=function(a){return(new this(a)).save()};d.uid=function(){return o()};d.exists=function(a){try{return this.find(a)}catch(f){return false}};d.find=function(a){a=this.records[a];if(!a)throw Error("Unknown record");return a.clone()};d.findBy=function(a,f){var c,e,b;b=this.records;for(e in b){c=b[e];if(c[a]===f)return c.clone()}throw Error("Unknown record");};d.select=function(a){var f,
c;return this.cloneArray(function(){var e,b;e=this.records;b=[];for(c in e){f=e[c];a(f)&&b.push(f)}return b}.call(this))};d.each=function(a){var f,c,e,b;e=this.records;b=[];for(f in e){c=e[f];b.push(a(c.clone()))}return b};d.all=function(){return this.cloneArray(this.recordsValues())};d.count=function(){return this.recordsValues().length};d.cloneArray=function(a){var f,c,e,b;b=[];c=0;for(e=a.length;c<e;c++){f=a[c];b.push(f.clone())}return b};d.recordsValues=function(){var a,f,c,e;f=[];e=this.records;
for(a in e){c=e[a];f.push(c)}return f};d.destroyAll=function(){return this.records={}};d.prototype.isNew=function(){return!this.exists()};d.prototype.exists=function(){return this.uid&&this.uid in this.constructor.records};d.prototype.clone=function(){return createObject(this)};d.prototype.load=function(a){var f,c;for(f in a){c=a[f];typeof this[f]==="function"&&this[f](c);this[f]=c}return this};d.prototype.attributes=function(){var a,f,c,e,b;f={};b=this.constructor.attributes;c=0;for(e=b.length;c<
e;c++){a=b[c];if(a in this)f[a]=typeof this[a]==="function"?this[a]():this[a]}return f};d.prototype.equal=function(a){return!!(a&&a.constructor===this.constructor&&a.uid&&a.uid===this.uid)};d.prototype.save=function(){var a;if(this.validate!=null)a=this.validate();if(a){this.trigger("error",a);return false}this.trigger("beforeSave");a=this.isNew()?this.create():this.update();this.trigger("save");return a};d.prototype.updateAttributes=function(a){this.load(a);return this.save()};d.prototype.changeUID=
function(a){var f;f=this.constructor.records;f[a]=f[this.uid];delete f[this.uid];this.uid=a;return this.save()};d.prototype.create=function(){var a;this.trigger("beforeCreate");a=new this.constructor(this.attributes());a.uid=this.uid;this.constructor.records[this.uid]=a;this.trigger("create");this.trigger("change","create");return a.clone()};d.prototype.update=function(){var a;this.trigger("beforeUpdate");a=this.constructor.records;a[this.uid].load(this.attributes());this.trigger("update");this.trigger("change",
"update");return a[this.uid].clone()};d.prototype.destroy=function(){this.trigger("beforeDestroy");delete this.constructor.records[this.uid];this.trigger("destroy");this.trigger("change","destroy");this.unbind();return this};d.prototype.clone=function(){return Object.create(this)};d.prototype.unbind=function(){return this.trigger("unbind")};d.prototype.trigger=function(){var a,f;a=1<=arguments.length?j.call(arguments,0):[];a.splice(1,0,this);return(f=this.constructor).trigger.apply(f,a)};return d}(Monocle.Module);
if(typeof Object.create!=="function")Object.create=function(g){var d;d=function(){};d.prototype=g;return new d};o=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(g){var d;d=Math.random()*16|0;return(g==="x"?d:d&3|8).toString(16)}).toUpperCase()}}).call(this);(function(){var o=function(j,g){return function(){return j.apply(g,arguments)}},m={}.hasOwnProperty,k=function(j,g){function d(){this.constructor=j}for(var a in g)if(m.call(g,a))j[a]=g[a];d.prototype=g.prototype;j.prototype=new d;j.__super__=g.prototype;return j};Monocle.Controller=function(j){function g(d){this.destroy=o(this.destroy,this);var a,f;if(typeof d==="string")this.el=Monocle.Dom(d);else for(a in d){f=d[a];this[a]=f}if(!this.el)this.el=Monocle.Dom(document.createElement(this.tag));if(!this.events)this.events=
this.constructor.events;if(!this.elements)this.elements=this.constructor.elements;this.events&&this.delegateEvents();this.elements&&this.refreshElements();g.__super__.constructor.apply(this,arguments)}k(g,j);g.include(Monocle.Events);g.prototype.eventSplitter=/^(\S+)\s*(.*)$/;g.prototype.tag="div";g.prototype.delegateEvents=function(){var d,a,f,c,e,b;e=this.events;b=[];for(a in e){c=e[a];if(typeof c!=="function")c=this.proxy(this[c]);f=a.match(this.eventSplitter);d=f[1];f=f[2];f===""?b.push(this.el.bind(d,
c)):b.push(this.el.delegate(f,d,c))}return b};g.prototype.refreshElements=function(){var d,a,f,c;f=this.elements;c=[];for(d in f){a=f[d];c.push(this[a]=this.el.find(d))}return c};g.prototype.destroy=function(){this.trigger("release");this.el.remove();return this.unbind()};return g}(Monocle.Module)}).call(this);(function(){var o={}.hasOwnProperty,m=function(j,g){function d(){this.constructor=j}for(var a in g)if(o.call(g,a))j[a]=g[a];d.prototype=g.prototype;j.prototype=new d;j.__super__=g.prototype;return j},k=[].slice;Monocle.View=function(j){function g(){g.__super__.constructor.apply(this,arguments);if(!this.template)this.template=this.constructor.template;this.template||this._loadTemplateFrom(this.template_url);if(!this.container)this.container=this.constructor.container;this.container=Monocle.Dom(this.container);
this.container.attr("data-monocle",this.constructor.name)}m(g,j);g.container=void 0;g.template_uri=void 0;g.template=void 0;g.model=void 0;g.prototype.html=function(){var d;d=1<=arguments.length?k.call(arguments,0):[];return this._html.apply(this,["html"].concat(k.call(d)))};g.prototype.append=function(){var d;d=1<=arguments.length?k.call(arguments,0):[];return this._html.apply(this,["append"].concat(k.call(d)))};g.prototype.prepend=function(){var d;d=1<=arguments.length?k.call(arguments,0):[];return this._html.apply(this,
["prepend"].concat(k.call(d)))};g.prototype.remove=function(){this.model.destroy();return this.el.remove()};g.prototype.replace=function(d){var a;a=[this.el,Monocle.Dom(d.el||d)];d=a[0];this.el=a[1];d.replaceWith(this.el[0]);this.delegateEvents(this.events);this.refreshElements();return this.el};g.prototype.refresh=function(){return this.replace(Monocle.templayed(this.template)(this.model))};g.prototype._html=function(){var d,a,f;f=arguments[0];a=2<=arguments.length?k.call(arguments,1):[];a=function(){var c,
e,b;b=[];c=0;for(e=a.length;c<e;c++){d=a[c];b.push(d.el||d)}return b}();this.replace(Monocle.templayed(this.template).apply(null,a));this.container[f](this.el[0]);return this};g.prototype._loadTemplateFrom=function(d){var a,f;a=this.constructor.name;if(!Monocle.Templates[a]){f=typeof $$!=="undefined"&&$$!==null?$$:$;d=f.ajax({url:d,async:false,dataType:"text",error:function(){return console.error(arguments)}});if(typeof $$==="undefined"||$$===null)d=d.responseText;Monocle.Templates[a]=d}return this.template=
Monocle.Templates[a]};return g}(Monocle.Controller)}).call(this);(function(){Monocle.templayed=function(o){var m,k,j,g;k=function(d,a){var f,c,e;a=1;d=d.replace(/\.\.\//g,function(){a++;return""});c=["data[data.length - ",a,"]"];e=d==="."?[]:d.split(".");for(f=0;f<e.length;){c.push("."+e[f]);f++}return c.join("")};g=function(d){return d.replace(/\{\{(!|&|\{)?\s*(.*?)\s*}}+/g,function(a,f,c){if(f==="!")return"";a=j++;return['"; var o',a," = ",k(c),", s",a," = (((typeof(o",a,') == "function" ? o',a,".call(data[data.length - 1]) : o",a,') || "") + ""); s += ',f?"s"+
a:'(/[&"><]/.test(s'+a+") ? s"+a+'.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/>/g,"&gt;").replace(/</g,"&lt;") : s'+a+")",' + "'].join("")})};m=function(d){return g(d.replace(/\{\{(\^|#)(.*?)}}(.*?)\{\{\/\2}}/g,function(a,f,c,e){a=j++;return['"; var o',a," = ",k(c),"; ",(f==="^"?["if ((o",a," instanceof Array) ? !o",a,".length : !o",a,') { s += "',m(e),'"; } ']:["if (typeof(o",a,') == "boolean" && o',a,') { s += "',m(e),'"; } else if (o',a,") { for (var i",a," = 0; i",a," < o",a,".length; i",
a,"++) { data.push(o",a,"[i",a,']); s += "',m(e),'"; data.pop(); }}']).join(""),'; s += "'].join("")}))};j=0;return new Function("data",'data = [data], s = "'+m(o.replace(/"/g,'\\"').replace(/\n/g,"\\n"))+'"; return s;')}}).call(this);(function(){var o,m,k,j,g={}.hasOwnProperty,d=function(f,c){function e(){this.constructor=f}for(var b in c)if(g.call(c,b))f[b]=c[b];e.prototype=c.prototype;f.prototype=new e;f.__super__=c.prototype;return f},a=[].slice;Monocle.Route=function(f){function c(b,i){var h;this.path=b;this.callback=i;this.names=[];if(typeof b==="string"){for(k.lastIndex=0;(h=k.exec(b))!==null;)this.names.push(h[1]);for(j.lastIndex=0;(h=j.exec(b))!==null;)this.names.push(h[1]);b=b.replace(o,"\\$&").replace(k,"([^/]*)").replace(j,
"(.*?)");this.route=RegExp("^"+b+"$")}else this.route=b}var e;d(c,f);c.extend(Monocle.Events);c.historySupport=((e=window.history)!=null?e.pushState:void 0)!=null;c.routes=[];c.options={trigger:true,history:false};c.listen=function(b){if(b==null)b={};this.options=this.extend(this.options,b);if(this.options.history)this.history=this.historySupport&&this.options.history;Monocle.Dom(window).bind(this.getEventName(),this.change);return this.change()};c.add=function(b,i){var h,l,n;if(typeof b==="object"&&
!(b instanceof RegExp)){n=[];for(h in b){l=b[h];n.push(this.add(h,l))}return n}else return this.routes.push(new this(b,i))};c.unbind=function(){return Monocle.Dom(window).unbind(this.getEventName(),this.change)};c.navigate=function(){var b,i,h;b=1<=arguments.length?a.call(arguments,0):[];h={};i=b[b.length-1];if(typeof i==="object")h=b.pop();else if(typeof i==="boolean")h.trigger=b.pop();h=this.extend(this.options,h);b=b.join("/");if(b!==this.path){this.path=b;this.trigger("navigate",this.path);h.trigger&&
this.matchRoute(this.path,h);if(this.history)history.pushState({},document.title,this.path);else window.location.hash=this.path}return this};c.extend=function(b,i){var h,l;if(b==null)b={};for(h in i){l=i[h];b[h]=l}return b};c.getEventName=function(){return this.history?"popstate":"hashchange"};c.getPath=function(){var b;b=window.location.pathname;if(b.substr(0,1)!=="/")b="/"+b;return b};c.getFragment=function(){return this.getHash().replace(m,"")};c.getHost=function(){return(document.location+"").replace(this.getPath()+
this.getHash(),"")};c.getHash=function(){return window.location.hash};c.change=function(){var b;b=this.history?this.getPath():this.getFragment();if(b!==this.path){this.path=b;this.matchRoute(this.path)}return this};c.matchRoute=function(b,i){var h,l,n,p;p=this.routes;l=0;for(n=p.length;l<n;l++){h=p[l];if(h.match(b,i)){this.trigger("change",h,b);return h}}};c.prototype.match=function(b,i){var h,l,n,p,q;if(i==null)i={};h=this.route.exec(b);if(!h)return false;i.match=h;if(this.names.length){q=h.slice(1);
h=n=0;for(p=q.length;n<p;h=++n){l=q[h];i[this.names[h]]=l}}return this.callback.call(null,i)!==false};return c}(Monocle.Module);m=/^#*/;k=/:([\w\d]+)/g;j=/\*([\w\d]+)/g;o=/[-[\]{}()+?.,\\^$|#\s]/g;Monocle.Route.change=Monocle.Route.proxy(Monocle.Route.change);Monocle.Controller.include({route:function(f,c){return Monocle.Route.add(f,this.proxy(c))},routes:function(f){var c,e,b;b=[];for(c in f){e=f[c];b.push(this.route(c,e))}return b},url:function(){return Monocle.Route.navigate.apply(Monocle.Route,
arguments)}})}).call(this);
